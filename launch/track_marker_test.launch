<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="world_version" default="2"/>

  <include file="$(find tiago_sim_hospital)/launch/tiago_manipulation_hospital.launch">
    <arg name="world_version" value="$(arg world_version)"/>
  </include>

  <arg name="markerId"        default="582"/>
  <arg name="markerSize"      default="0.10"/>    <!-- in m -->

  <node pkg="aruco_ros" type="single"  name="aruco_single">
    <remap from="/camera_info"       to="/xtion/rgb/camera_info" />
    <remap from="/image"             to="/xtion/rgb/image_rect_color" />
    <param name="image_is_rectified" value="true"/>
    <param name="marker_size"        value="$(arg markerSize)"/>
    <param name="marker_id"          value="$(arg markerId)"/>
    <param name="reference_frame"    value="/base_footprint"/>   <!-- frame in which the marker pose will be expressed -->
    <param name="camera_frame"       value="/xtion_rgb_optical_frame"/>
    <param name="marker_frame"       value="/aruco_frame" />
    <param name="corner_refinement"  value="SUBPIX" />
  </node>

  <node pkg="tiago_sim_hospital" type="follow_marker" name="arm_follow_marker">
  </node>

  <!-- spawn marker plate-->
  <arg name="marker_plate_file" default="$(find tiago_sim_hospital)/models/marker_plate/model.sdf"/>
  <node name="marker_plate_spawner" pkg="gazebo_ros" type="spawn_model"
        args="-x -7 -y -4 -z 1 -sdf -model marker_plate -file $(arg marker_plate_file)" respawn="false" output="screen" />

</launch>
